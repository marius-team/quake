# General settings
overwrite:
  index_files: false # If true, rebuilds all L0 index files
  results_csv: true  # If true, re-runs searches and overwrites result CSVs

dataset:
  name: sift10m
  metric: l2
  nq: 100

# --- L0 (Base Level) Definitions ---
l0_definitions:
  "L0_40k_config":  # Unique reference name for this L0 build configuration
    type: Quake
    build_params:
      nlist: 40000
      num_workers: 4
  "L0_10k_config":
    type: Quake
    build_params:
      nlist: 10000
      num_workers: 4

# --- Global L0 Search Sweep ---
global_l0_search_sweep:
  nprobes: [1, 2, 4, 8, 16, 32, 64, 128, 256] # List of nprobe values for L0
  # recall_targets: [0.5, 0.6, 0.7, 0.8, 0.85, 0.9, 0.95, 0.99] # Alternative L0 sweep
  # initial_search_fraction: 0.01 # Required if using recall_targets
  k: 1            # k for L0 search (and overall recall calculation)
  batch_size: 1    # Query batch_size for L0 search

# --- Index Hierarchy Definitions ---
index_hierarchies:
  - name: "Flat_L0_40k"        # Unique name for this specific hierarchy/curve
    l0_ref: "L0_40k_config"    # Referenlistes an L0 from 'l0_definitions'
    # parent_levels: (empty or omitted) -> This is a flat index using the referenlisted L0.

  - name: "Flat_L0_10k"        # Unique name for this specific hierarchy/curve
    l0_ref: "L0_10k_config"    # Referenlistes an L0 from 'l0_definitions'
    # parent_levels: (empty or omitted) -> This is a flat index using the referenlisted L0.


  - name: "Hier_L0_40k_L1_1k_P50" # Name implies: L0 is 40k, L1 is 1k centroids, L1 nprobe is 50
    l0_ref: "L0_40k_config"
    parent_levels:             # List of parent levels (L1, L2, ...) built on top of L0
      - type: Quake            # L1 configuration
        build_params: {nlist: 1000, num_workers: 8}
        search_params: {nprobe: 50} # Fixed search parameters for this L1 scan

  - name: "Hier_L0_10k_L1_0.5k_P20"
    l0_ref: "L0_10k_config"
    parent_levels:
      - type: Quake # L1
        build_params: {nlist: 500, num_workers: 8}
        search_params: {nprobe: 20}

  - name: "Custom_Flat_L0_5k"      # Defines its L0 ad-hoc (not from l0_definitions)
    custom_l0:                    # L0 definition specific to this hierarchy
      type: Quake
      build_params: {nlist: 5000, num_workers: 8}
    # parent_levels: (empty or omitted) -> This is a custom flat L0.

# --- General Run Settings ---
run_settings:
  trials: 3
  warmup: 1
  default_batch_size: 1
  omp_threads_build: "16"  # Or "MAX" as a placeholder for max available
  omp_threads_search: "1"

plot_styles:
  "Flat_L0_40k": {color: "#1f77b4", marker: "o"}
  "Hier_L0_40k_L1_1k_P50": {color: "#ff7f0e", marker: "s"}
  "Hier_L0_10k_L1_0.5k_P20": {color: "#2ca02c", marker: "D"}
  "Custom_Flat_L0_5k": {color: "#d62728", marker: "^"}